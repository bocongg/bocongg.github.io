{"title":"Data story project","markdown":{"yaml":{"title":"Data story project","filters":["shinylive"]},"headingText":"What contributes to the difference in wait times for admission to wards in local public hospitals?","containsRefs":false,"markdown":"\n\n\nThe CNA had reported in April 2023 that the median waiting time for ward admissions had increased from about 5 hours to 7.2 hours during that period^[1](https://www.channelnewsasia.com/singapore/moh-hospital-waiting-times-7-hours-covid-19-3442136)^. The health ministry had explained that it was due to the rise in number of older patients with more complex medical needs requiring longer hospitalisation^[1](https://www.channelnewsasia.com/singapore/moh-hospital-waiting-times-7-hours-covid-19-3442136)^. Due to the ageing population in Singapore, long waiting time for admission to wards has been a long-standing issue over the years, and it was further exacerbated by the Covid-19 pandemic^[2](https://www.channelnewsasia.com/singapore/hospitals-beds-waiting-time-50-hours-admission-ng-teng-fong-sengkang-3014596),[3](https://www.straitstimes.com/singapore/health/most-public-hospitals-saw-more-ae-patients-in-past-week-compared-with-past-month)^.\n\n```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(tidyr)\nlibrary(readr)\nlibrary(lubridate)\nlibrary(plyr)\nlibrary(scales)\nlibrary(zoo)\nlibrary(leaflet)\nlibrary(htmltools)\nlibrary(plotly)\nlibrary(ggh4x)\nlibrary(ggrepel)\n\n\nwait_times <- read_csv(\"./Proj dataset/test_waiting_time.csv\")\n\nbed_occ <- read_csv(\"./Proj dataset/test_BOR.csv\")\n\nEMD_attendance <- read_csv(\"./Proj dataset/test_EMD_attendance.csv\")\n\n\ntidy_wait_times <- wait_times %>%\n                    separate(col = Date, into = c(\"Day_wk\", \"Date\"), sep = \", \") %>%\n                    mutate(new_Date_format = \n                             parse_date_time(Date, orders = c(\"mdy\", \"dmy\", \"ymd\"))) %>%\n                    mutate(Dates = format(new_Date_format, \"%d/%m/%Y\")) %>%\n                    separate(col = Date, into = c(\"Day\", \"Month\", \"Year\"), sep = \"/\") %>%\n                    gather(key = hospital, value = wait_duration, 5:12 ) %>%\n                    select(Day_wk, Dates, Day, Month, Year, hospital, wait_duration)\n\ntidy_bed_occ <- bed_occ %>%\n                  filter(Years == 2023) %>%\n                  mutate(new_Date_format = \n                           parse_date_time(Date, orders = c(\"mdy\", \"dmy\", \"ymd\"))) %>%\n                  mutate(Dates = format(new_Date_format, \"%d/%m/%Y\")) %>%\n                  gather(key = hospital, value = occ_rate, 3:10) %>%\n                  separate(col = occ_rate, into = c(\"occ_rate\"), sep = \"%\") %>%\n                  mutate(occ_rate_num = as.numeric(occ_rate)) %>%\n                  select(occ_rate_num)\n\ntidy_EMD_attendance <- EMD_attendance %>%\n                        separate(col = Date, into = c(\"Day_wk\", \"Date\"), sep = \", \") %>%\n                        mutate(new_Date_format = \n                                parse_date_time(Date, orders = c(\"mdy\", \"dmy\", \"ymd\"))) %>%\n                        mutate(Dates = format(new_Date_format, \"%d/%m/%Y\")) %>%\n                        separate(col = Date, into = c(\"Day\", \"Month\", \"Year\"), sep = \"/\") %>%\n                        gather(key = hospital, value = attendance, 5:12) %>%\n                        select(attendance)\n\nfinal_dataset <- cbind(tidy_wait_times,tidy_bed_occ,tidy_EMD_attendance)\n\nfinal_dataset <- \n  final_dataset %>%\n    mutate(new_Date_format = \n           parse_date_time(Dates, orders = c(\"mdy\", \"dmy\", \"ymd\"))) %>%\n    mutate(week_num = as.numeric(format(new_Date_format, \"%U\"))) %>%\n    mutate(fullmonth = format(new_Date_format, \"%b\")) %>%\n    mutate(yearmonth = as.yearmon(new_Date_format)) %>%\n    mutate(yearmonthf = factor(yearmonth)) %>%\n    ddply(.(yearmonthf), transform, monthweek=5-week_num+min(week_num)) %>%\n    select(-new_Date_format,-yearmonth,-yearmonthf)\n```\n\n#### Line chart\n```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nWT_line <- final_dataset %>% \n  filter(Month == \"01\") %>%\n    ggplot(aes(x = Dates,\n           text = paste(wait_duration, \"hrs\"))) + \n    geom_point(aes(y = wait_duration), size = 0.75) + \n    geom_line(aes(y = wait_duration, group = hospital, color = hospital)) +\n    labs(title = \"Waiting Time for Admission to Ward\",\n         subtitle = \"January 2023\",\n         x = \"Date\",\n         y = \"Hours (h)\",\n         colour = \"Hospital\",\n         caption = \"Source: Ministry of Health\") +\n    theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\nBOR_line <- final_dataset %>% \n  filter(Month == \"01\") %>%\n    ggplot(aes(x = Dates,\n           text = paste(occ_rate_num, \"%\"))) + \n    geom_point(aes(y = occ_rate_num), size = 0.75) + \n    geom_line(aes(y = occ_rate_num, group = hospital, color = hospital)) +\n    labs(title = \"Bed Occupancy Rate (%)\",\n         subtitle = \"January 2023\",\n         x = \"Date\",\n         y = \"BOR (%)\",\n         colour = \"Hospital\",\n         caption = \"Source: Ministry of Health\") +\n    theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\nEMD_line <- final_dataset %>% \n  filter(Month == \"01\") %>%\n    ggplot(aes(x = Dates,\n           text = paste(wait_duration, \"patients\"))) + \n    geom_point(aes(y = attendance), size = 0.75) + \n    geom_line(aes(y = attendance, group = hospital, color = hospital)) +\n    labs(title = \"Attendance at Emergency Medicine Department\",\n         subtitle = \"January 2023\",\n         x = \"Date\",\n         y = \"No. of patients\",\n         colour = \"Hospital\",\n         caption = \"Source: Ministry of Health\") +\n    theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\nggplotly(WT_line, tooltip = \"text\") %>%\n  config(displayModeBar = FALSE) %>%\n  layout(dragmode = FALSE,\n         title = list(text = paste0('Waiting Time for Admission to Ward',\n                                    '<br>',\n                                    '<sup>',\n                                    'January 2023',\n                                    '</sup>')))\n\nggplotly(BOR_line, tooltip = \"text\") %>%\n  config(displayModeBar = FALSE) %>%\n  layout(dragmode = FALSE,\n         title = list(text = paste0('Bed Occupancy Rate (%)',\n                                    '<br>',\n                                    '<sup>',\n                                    'January 2023',\n                                    '</sup>')))\n\nggplotly(EMD_line, tooltip = \"text\") %>%\n  config(displayModeBar = FALSE) %>%\n  layout(dragmode = FALSE,\n         title = list(text = paste0('Attendance at Emergency Medicine Department',\n                                    '<br>',\n                                    '<sup>',\n                                    'January 2023',\n                                    '</sup>')))\n```\n\n#### Boxplot\n```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nfinal_dataset %>% \n  filter(Month == \"01\") %>%\n    ggplot(aes(x = wait_duration,\n               y = fct_reorder(hospital, desc(hospital)))) + \n    geom_boxplot(aes(fill = hospital)) + \n    labs(title = \"Waiting Time for Admission to Ward\",\n         subtitle = \"January, 2023\",\n         x = \"Hours (h)\",\n         y = \"Hospital\",\n         caption = \"Source: Ministry of Health\") +\n    theme(legend.position = \"none\")\n\nfinal_dataset %>% \n  filter(Month == \"01\") %>%\n    ggplot(aes(x = occ_rate_num,\n               y = fct_reorder(hospital, desc(hospital)))) + \n    geom_boxplot(aes(fill = hospital)) + \n    labs(title = \"Bed Occupancy Rate (%)\",\n         subtitle = \"January, 2023\",\n         x = \"BOR (%)\",\n         y = \"Hospital\",\n         caption = \"Source: Ministry of Health\") +\n    theme(legend.position = \"none\")\n\nfinal_dataset %>% \n  filter(Month == \"01\") %>%\n    ggplot(aes(x = attendance,\n               y = fct_reorder(hospital, desc(hospital)))) + \n    geom_boxplot(aes(fill = hospital)) + \n    labs(title = \"Attendance at Emergency Medicine Department\",\n         subtitle = \"January, 2023\",\n         x = \"No. of patients\",\n         y = \"Hospital\",\n         caption = \"Source: Ministry of Health\") +\n    theme(legend.position = \"none\")\n```\n\n#### Bar chart\n```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nfinal_dataset %>% \n  filter(Month == \"01\",\n         Day == \"01\") %>%\n    ggplot(aes(x = occ_rate_num)) + \n    geom_col(aes(y = fct_reorder(hospital, desc(hospital)),\n                 fill = hospital)) +\n    labs(title = \"Bed Occupancy Rate (BOR)\",\n         subtitle = \"01/01/2023\",\n         x = \"BOR (%)\",\n         y = \"Hospital\",\n         caption = \"Source: Ministry of Health\") +\n    geom_text(aes(occ_rate_num, hospital, label = occ_rate_num),\n              hjust = 1.3) +\n    theme(legend.position = \"none\")\n\nfinal_dataset %>% \n  filter(Month == \"01\",\n         Day == \"01\") %>%\n    ggplot(aes(x = attendance)) + \n    geom_col(aes(y = fct_reorder(hospital, desc(hospital)),\n                 fill = hospital)) +\n    labs(title = \"Attendance at Emergency Medicine Department\",\n         subtitle = \"01/01/2023\",\n         x = \"No. of patients\",\n         y = \"Hospital\",\n         caption = \"Source: Ministry of Health\") +\n    geom_text(aes(attendance, hospital, label = attendance),\n              hjust = 1.3) +\n    theme(legend.position = \"none\")\n```\n\n#### Calendar Heatmap\n```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\ncalendar_plot <- final_dataset %>%  \n  filter(hospital == \"AH\") %>%\n    ggplot(aes(x = fct_inorder(Day_wk),\n               y = monthweek,\n               fill = wait_duration,\n               text = paste(\"Waiting time:\", wait_duration, \"hrs\"))) + \n    geom_tile(colour = \"white\") +\n    geom_text(aes(label = Day),\n              color = \"black\",\n              size = 2) +\n    facet_wrap( ~ fct_inorder(fullmonth),\n                ncol = 3,\n                scales = \"fixed\") +\n    scale_fill_gradient(low=\"green\", high = \"red\") +\n    labs(x = \"Alexandra Hospital (2023)\",\n         y = \"\",\n         title = \"Waiting Time for Admission to Ward\",\n         subtitle = \"Alexandra Hospital (2023)\",\n         fill = \"Hours (h)\",\n         caption = \"Source: Ministry of Health\") +\n    theme(axis.text.y=element_blank(), \n          axis.ticks.y=element_blank()) +\n    scale_x_discrete(guide = guide_axis(angle = 90)) +\n    theme(panel.spacing.y = unit(1.1, \"cm\"))\n\nggplotly(calendar_plot, tooltip = \"text\") %>%\n  config(displayModeBar = FALSE) %>%\n  layout(dragmode = FALSE)\n```\n\n#### Line + bar chart\n```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nfinal_dataset %>% \n  filter(Month == \"01\",\n         hospital == \"AH\") %>%\n    ggplot(aes(x = Dates)) + \n    geom_col(aes(y = occ_rate_num/10), fill = \"lightgrey\") +\n    geom_point(aes(y = wait_duration), size = 2) + \n    geom_line(aes(y = wait_duration, group = hospital, color = hospital), size = 0.75) + \n    labs(title = \"Waiting Time for Admission to Ward & Bed Occupancy Rate (BOR)\",\n         subtitle = \"Alexandra Hospital (Jan, 2023)\",\n         x = \"Date\",\n         y = \"Hours (h)\",\n         caption = \"Source: Ministry of Health\") +\n    theme(legend.position = \"none\") +\n    scale_y_continuous(sec.axis = sec_axis(~.*10, name = \"BOR (%)\")) +\n    scale_x_discrete(guide = guide_axis(angle = 45))\n\nfinal_dataset %>% \n  filter(Month == \"01\",\n         hospital == \"AH\") %>%\n    ggplot(aes(x = Dates)) + \n    geom_col(aes(y = attendance/10), fill = \"lightgrey\") +\n    geom_point(aes(y = wait_duration), size = 2) + \n    geom_line(aes(y = wait_duration, group = hospital, color = hospital), size = 0.75) + \n    labs(title = \"Waiting Time for Admission to Ward & EMD Attendance\",\n         subtitle = \"Alexandra Hospital (Jan, 2023)\",\n         x = \"Date\",\n         y = \"Hours (h)\",\n         caption = \"Source: Ministry of Health\") +\n    theme(legend.position = \"none\") +\n    scale_y_continuous(sec.axis = sec_axis(~.*10, name = \"EMD Attendance\")) +\n    scale_x_discrete(guide = guide_axis(angle = 45))\n```\n#### Scatterplot\n```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nfinal_dataset %>%\n  filter(Month == \"01\",\n         hospital == \"AH\") %>%\n  ggplot(aes(wait_duration, occ_rate_num)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se=F) +\n  labs(title = \"Waiting Time for Admission to Ward & Bed Occupancy Rate (BOR)\",\n         subtitle = \"Alexandra Hospital (Jan, 2023)\",\n         x = \"Hours (h)\",\n         y = \"BOR (%)\",\n         caption = \"Source: Ministry of Health\")\n\nfinal_dataset %>%\n  filter(Month == \"01\",\n         hospital == \"AH\") %>%\n  ggplot(aes(wait_duration, attendance)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se=F) +\n  labs(title = \"Waiting Time for Admission to Ward & EMD attendance\",\n         subtitle = \"Alexandra Hospital (Jan, 2023)\",\n         x = \"Hours (h)\",\n         y = \"No. of patients\",\n         caption = \"Source: Ministry of Health\")\n```\n\n```{r, eval=FALSE, echo=FALSE, message=FALSE, warning=FALSE}\nfinal_dataset %>%\n  filter(Month == \"01\",\n         Dates == \"01/01/2023\") %>%\n    ggplot(aes(x = \"\", y = attendance, fill = factor(hospital))) + \n    geom_bar(width = 1, stat = \"identity\", color = \"white\") + \n    theme(axis.line = element_blank(),\n          plot.title = element_text(hjust = 0.5)) +\n    labs(title = \"Attendances at Emergency Medicine Department, 1st January (2023)\",\n         x = NULL,\n         y = NULL,\n         fill = \"Hospital\",\n         caption = \"Source: Ministry of Health\") +\n    coord_polar(theta = \"y\", start = 0) +\n    geom_text(aes(label = attendance),\n              position = position_stack(vjust = 0.5),\n              size = 5) +\n    theme_void()\n\n\n```\n\n\n```{r, eval=FALSE, echo=FALSE, message=FALSE, warning=FALSE}\ndf <- read.csv(textConnection(\n  \"Name,Lat,Long\n  Singapore General Hospital (SGH),103.8348,1.2804\n  Changi General Hospital(CGH),103.9496,1.3402\n  Sengkang General Hospital (SKH),103.8931,1.3943\n  National University Hospital (NUH),103.7831,1.2939\n  Ng Teng Fong General Hospital (NTFGH),103.7439,1.3350\n  Alexandra Hospital (AH),103.8013,1.2866\n  Tan Tock Seng Hospital (TTSH),103.8458,1.3214\n  Khoo Teck Puat Hospital (KTPH),103.8394,1.4241\"))\n\nleaflet(df) %>%\n  addTiles() %>%\n   addMarkers(~Long, ~Lat, label = ~htmlEscape(Name)) %>%\n    setView(lng = 103.8, lat = 1.366667, zoom = 12)\n```","srcMarkdownNoYaml":"\n\n### What contributes to the difference in wait times for admission to wards in local public hospitals?\n\nThe CNA had reported in April 2023 that the median waiting time for ward admissions had increased from about 5 hours to 7.2 hours during that period^[1](https://www.channelnewsasia.com/singapore/moh-hospital-waiting-times-7-hours-covid-19-3442136)^. The health ministry had explained that it was due to the rise in number of older patients with more complex medical needs requiring longer hospitalisation^[1](https://www.channelnewsasia.com/singapore/moh-hospital-waiting-times-7-hours-covid-19-3442136)^. Due to the ageing population in Singapore, long waiting time for admission to wards has been a long-standing issue over the years, and it was further exacerbated by the Covid-19 pandemic^[2](https://www.channelnewsasia.com/singapore/hospitals-beds-waiting-time-50-hours-admission-ng-teng-fong-sengkang-3014596),[3](https://www.straitstimes.com/singapore/health/most-public-hospitals-saw-more-ae-patients-in-past-week-compared-with-past-month)^.\n\n```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(tidyr)\nlibrary(readr)\nlibrary(lubridate)\nlibrary(plyr)\nlibrary(scales)\nlibrary(zoo)\nlibrary(leaflet)\nlibrary(htmltools)\nlibrary(plotly)\nlibrary(ggh4x)\nlibrary(ggrepel)\n\n\nwait_times <- read_csv(\"./Proj dataset/test_waiting_time.csv\")\n\nbed_occ <- read_csv(\"./Proj dataset/test_BOR.csv\")\n\nEMD_attendance <- read_csv(\"./Proj dataset/test_EMD_attendance.csv\")\n\n\ntidy_wait_times <- wait_times %>%\n                    separate(col = Date, into = c(\"Day_wk\", \"Date\"), sep = \", \") %>%\n                    mutate(new_Date_format = \n                             parse_date_time(Date, orders = c(\"mdy\", \"dmy\", \"ymd\"))) %>%\n                    mutate(Dates = format(new_Date_format, \"%d/%m/%Y\")) %>%\n                    separate(col = Date, into = c(\"Day\", \"Month\", \"Year\"), sep = \"/\") %>%\n                    gather(key = hospital, value = wait_duration, 5:12 ) %>%\n                    select(Day_wk, Dates, Day, Month, Year, hospital, wait_duration)\n\ntidy_bed_occ <- bed_occ %>%\n                  filter(Years == 2023) %>%\n                  mutate(new_Date_format = \n                           parse_date_time(Date, orders = c(\"mdy\", \"dmy\", \"ymd\"))) %>%\n                  mutate(Dates = format(new_Date_format, \"%d/%m/%Y\")) %>%\n                  gather(key = hospital, value = occ_rate, 3:10) %>%\n                  separate(col = occ_rate, into = c(\"occ_rate\"), sep = \"%\") %>%\n                  mutate(occ_rate_num = as.numeric(occ_rate)) %>%\n                  select(occ_rate_num)\n\ntidy_EMD_attendance <- EMD_attendance %>%\n                        separate(col = Date, into = c(\"Day_wk\", \"Date\"), sep = \", \") %>%\n                        mutate(new_Date_format = \n                                parse_date_time(Date, orders = c(\"mdy\", \"dmy\", \"ymd\"))) %>%\n                        mutate(Dates = format(new_Date_format, \"%d/%m/%Y\")) %>%\n                        separate(col = Date, into = c(\"Day\", \"Month\", \"Year\"), sep = \"/\") %>%\n                        gather(key = hospital, value = attendance, 5:12) %>%\n                        select(attendance)\n\nfinal_dataset <- cbind(tidy_wait_times,tidy_bed_occ,tidy_EMD_attendance)\n\nfinal_dataset <- \n  final_dataset %>%\n    mutate(new_Date_format = \n           parse_date_time(Dates, orders = c(\"mdy\", \"dmy\", \"ymd\"))) %>%\n    mutate(week_num = as.numeric(format(new_Date_format, \"%U\"))) %>%\n    mutate(fullmonth = format(new_Date_format, \"%b\")) %>%\n    mutate(yearmonth = as.yearmon(new_Date_format)) %>%\n    mutate(yearmonthf = factor(yearmonth)) %>%\n    ddply(.(yearmonthf), transform, monthweek=5-week_num+min(week_num)) %>%\n    select(-new_Date_format,-yearmonth,-yearmonthf)\n```\n\n#### Line chart\n```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nWT_line <- final_dataset %>% \n  filter(Month == \"01\") %>%\n    ggplot(aes(x = Dates,\n           text = paste(wait_duration, \"hrs\"))) + \n    geom_point(aes(y = wait_duration), size = 0.75) + \n    geom_line(aes(y = wait_duration, group = hospital, color = hospital)) +\n    labs(title = \"Waiting Time for Admission to Ward\",\n         subtitle = \"January 2023\",\n         x = \"Date\",\n         y = \"Hours (h)\",\n         colour = \"Hospital\",\n         caption = \"Source: Ministry of Health\") +\n    theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\nBOR_line <- final_dataset %>% \n  filter(Month == \"01\") %>%\n    ggplot(aes(x = Dates,\n           text = paste(occ_rate_num, \"%\"))) + \n    geom_point(aes(y = occ_rate_num), size = 0.75) + \n    geom_line(aes(y = occ_rate_num, group = hospital, color = hospital)) +\n    labs(title = \"Bed Occupancy Rate (%)\",\n         subtitle = \"January 2023\",\n         x = \"Date\",\n         y = \"BOR (%)\",\n         colour = \"Hospital\",\n         caption = \"Source: Ministry of Health\") +\n    theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\nEMD_line <- final_dataset %>% \n  filter(Month == \"01\") %>%\n    ggplot(aes(x = Dates,\n           text = paste(wait_duration, \"patients\"))) + \n    geom_point(aes(y = attendance), size = 0.75) + \n    geom_line(aes(y = attendance, group = hospital, color = hospital)) +\n    labs(title = \"Attendance at Emergency Medicine Department\",\n         subtitle = \"January 2023\",\n         x = \"Date\",\n         y = \"No. of patients\",\n         colour = \"Hospital\",\n         caption = \"Source: Ministry of Health\") +\n    theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\nggplotly(WT_line, tooltip = \"text\") %>%\n  config(displayModeBar = FALSE) %>%\n  layout(dragmode = FALSE,\n         title = list(text = paste0('Waiting Time for Admission to Ward',\n                                    '<br>',\n                                    '<sup>',\n                                    'January 2023',\n                                    '</sup>')))\n\nggplotly(BOR_line, tooltip = \"text\") %>%\n  config(displayModeBar = FALSE) %>%\n  layout(dragmode = FALSE,\n         title = list(text = paste0('Bed Occupancy Rate (%)',\n                                    '<br>',\n                                    '<sup>',\n                                    'January 2023',\n                                    '</sup>')))\n\nggplotly(EMD_line, tooltip = \"text\") %>%\n  config(displayModeBar = FALSE) %>%\n  layout(dragmode = FALSE,\n         title = list(text = paste0('Attendance at Emergency Medicine Department',\n                                    '<br>',\n                                    '<sup>',\n                                    'January 2023',\n                                    '</sup>')))\n```\n\n#### Boxplot\n```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nfinal_dataset %>% \n  filter(Month == \"01\") %>%\n    ggplot(aes(x = wait_duration,\n               y = fct_reorder(hospital, desc(hospital)))) + \n    geom_boxplot(aes(fill = hospital)) + \n    labs(title = \"Waiting Time for Admission to Ward\",\n         subtitle = \"January, 2023\",\n         x = \"Hours (h)\",\n         y = \"Hospital\",\n         caption = \"Source: Ministry of Health\") +\n    theme(legend.position = \"none\")\n\nfinal_dataset %>% \n  filter(Month == \"01\") %>%\n    ggplot(aes(x = occ_rate_num,\n               y = fct_reorder(hospital, desc(hospital)))) + \n    geom_boxplot(aes(fill = hospital)) + \n    labs(title = \"Bed Occupancy Rate (%)\",\n         subtitle = \"January, 2023\",\n         x = \"BOR (%)\",\n         y = \"Hospital\",\n         caption = \"Source: Ministry of Health\") +\n    theme(legend.position = \"none\")\n\nfinal_dataset %>% \n  filter(Month == \"01\") %>%\n    ggplot(aes(x = attendance,\n               y = fct_reorder(hospital, desc(hospital)))) + \n    geom_boxplot(aes(fill = hospital)) + \n    labs(title = \"Attendance at Emergency Medicine Department\",\n         subtitle = \"January, 2023\",\n         x = \"No. of patients\",\n         y = \"Hospital\",\n         caption = \"Source: Ministry of Health\") +\n    theme(legend.position = \"none\")\n```\n\n#### Bar chart\n```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nfinal_dataset %>% \n  filter(Month == \"01\",\n         Day == \"01\") %>%\n    ggplot(aes(x = occ_rate_num)) + \n    geom_col(aes(y = fct_reorder(hospital, desc(hospital)),\n                 fill = hospital)) +\n    labs(title = \"Bed Occupancy Rate (BOR)\",\n         subtitle = \"01/01/2023\",\n         x = \"BOR (%)\",\n         y = \"Hospital\",\n         caption = \"Source: Ministry of Health\") +\n    geom_text(aes(occ_rate_num, hospital, label = occ_rate_num),\n              hjust = 1.3) +\n    theme(legend.position = \"none\")\n\nfinal_dataset %>% \n  filter(Month == \"01\",\n         Day == \"01\") %>%\n    ggplot(aes(x = attendance)) + \n    geom_col(aes(y = fct_reorder(hospital, desc(hospital)),\n                 fill = hospital)) +\n    labs(title = \"Attendance at Emergency Medicine Department\",\n         subtitle = \"01/01/2023\",\n         x = \"No. of patients\",\n         y = \"Hospital\",\n         caption = \"Source: Ministry of Health\") +\n    geom_text(aes(attendance, hospital, label = attendance),\n              hjust = 1.3) +\n    theme(legend.position = \"none\")\n```\n\n#### Calendar Heatmap\n```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\ncalendar_plot <- final_dataset %>%  \n  filter(hospital == \"AH\") %>%\n    ggplot(aes(x = fct_inorder(Day_wk),\n               y = monthweek,\n               fill = wait_duration,\n               text = paste(\"Waiting time:\", wait_duration, \"hrs\"))) + \n    geom_tile(colour = \"white\") +\n    geom_text(aes(label = Day),\n              color = \"black\",\n              size = 2) +\n    facet_wrap( ~ fct_inorder(fullmonth),\n                ncol = 3,\n                scales = \"fixed\") +\n    scale_fill_gradient(low=\"green\", high = \"red\") +\n    labs(x = \"Alexandra Hospital (2023)\",\n         y = \"\",\n         title = \"Waiting Time for Admission to Ward\",\n         subtitle = \"Alexandra Hospital (2023)\",\n         fill = \"Hours (h)\",\n         caption = \"Source: Ministry of Health\") +\n    theme(axis.text.y=element_blank(), \n          axis.ticks.y=element_blank()) +\n    scale_x_discrete(guide = guide_axis(angle = 90)) +\n    theme(panel.spacing.y = unit(1.1, \"cm\"))\n\nggplotly(calendar_plot, tooltip = \"text\") %>%\n  config(displayModeBar = FALSE) %>%\n  layout(dragmode = FALSE)\n```\n\n#### Line + bar chart\n```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nfinal_dataset %>% \n  filter(Month == \"01\",\n         hospital == \"AH\") %>%\n    ggplot(aes(x = Dates)) + \n    geom_col(aes(y = occ_rate_num/10), fill = \"lightgrey\") +\n    geom_point(aes(y = wait_duration), size = 2) + \n    geom_line(aes(y = wait_duration, group = hospital, color = hospital), size = 0.75) + \n    labs(title = \"Waiting Time for Admission to Ward & Bed Occupancy Rate (BOR)\",\n         subtitle = \"Alexandra Hospital (Jan, 2023)\",\n         x = \"Date\",\n         y = \"Hours (h)\",\n         caption = \"Source: Ministry of Health\") +\n    theme(legend.position = \"none\") +\n    scale_y_continuous(sec.axis = sec_axis(~.*10, name = \"BOR (%)\")) +\n    scale_x_discrete(guide = guide_axis(angle = 45))\n\nfinal_dataset %>% \n  filter(Month == \"01\",\n         hospital == \"AH\") %>%\n    ggplot(aes(x = Dates)) + \n    geom_col(aes(y = attendance/10), fill = \"lightgrey\") +\n    geom_point(aes(y = wait_duration), size = 2) + \n    geom_line(aes(y = wait_duration, group = hospital, color = hospital), size = 0.75) + \n    labs(title = \"Waiting Time for Admission to Ward & EMD Attendance\",\n         subtitle = \"Alexandra Hospital (Jan, 2023)\",\n         x = \"Date\",\n         y = \"Hours (h)\",\n         caption = \"Source: Ministry of Health\") +\n    theme(legend.position = \"none\") +\n    scale_y_continuous(sec.axis = sec_axis(~.*10, name = \"EMD Attendance\")) +\n    scale_x_discrete(guide = guide_axis(angle = 45))\n```\n#### Scatterplot\n```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nfinal_dataset %>%\n  filter(Month == \"01\",\n         hospital == \"AH\") %>%\n  ggplot(aes(wait_duration, occ_rate_num)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se=F) +\n  labs(title = \"Waiting Time for Admission to Ward & Bed Occupancy Rate (BOR)\",\n         subtitle = \"Alexandra Hospital (Jan, 2023)\",\n         x = \"Hours (h)\",\n         y = \"BOR (%)\",\n         caption = \"Source: Ministry of Health\")\n\nfinal_dataset %>%\n  filter(Month == \"01\",\n         hospital == \"AH\") %>%\n  ggplot(aes(wait_duration, attendance)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se=F) +\n  labs(title = \"Waiting Time for Admission to Ward & EMD attendance\",\n         subtitle = \"Alexandra Hospital (Jan, 2023)\",\n         x = \"Hours (h)\",\n         y = \"No. of patients\",\n         caption = \"Source: Ministry of Health\")\n```\n\n```{r, eval=FALSE, echo=FALSE, message=FALSE, warning=FALSE}\nfinal_dataset %>%\n  filter(Month == \"01\",\n         Dates == \"01/01/2023\") %>%\n    ggplot(aes(x = \"\", y = attendance, fill = factor(hospital))) + \n    geom_bar(width = 1, stat = \"identity\", color = \"white\") + \n    theme(axis.line = element_blank(),\n          plot.title = element_text(hjust = 0.5)) +\n    labs(title = \"Attendances at Emergency Medicine Department, 1st January (2023)\",\n         x = NULL,\n         y = NULL,\n         fill = \"Hospital\",\n         caption = \"Source: Ministry of Health\") +\n    coord_polar(theta = \"y\", start = 0) +\n    geom_text(aes(label = attendance),\n              position = position_stack(vjust = 0.5),\n              size = 5) +\n    theme_void()\n\n\n```\n\n\n```{r, eval=FALSE, echo=FALSE, message=FALSE, warning=FALSE}\ndf <- read.csv(textConnection(\n  \"Name,Lat,Long\n  Singapore General Hospital (SGH),103.8348,1.2804\n  Changi General Hospital(CGH),103.9496,1.3402\n  Sengkang General Hospital (SKH),103.8931,1.3943\n  National University Hospital (NUH),103.7831,1.2939\n  Ng Teng Fong General Hospital (NTFGH),103.7439,1.3350\n  Alexandra Hospital (AH),103.8013,1.2866\n  Tan Tock Seng Hospital (TTSH),103.8458,1.3214\n  Khoo Teck Puat Hospital (KTPH),103.8394,1.4241\"))\n\nleaflet(df) %>%\n  addTiles() %>%\n   addMarkers(~Long, ~Lat, label = ~htmlEscape(Name)) %>%\n    setView(lng = 103.8, lat = 1.366667, zoom = 12)\n```"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"filters":["shinylive"],"output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.353","editor":"visual","theme":"sandstone","title":"Data story project"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}