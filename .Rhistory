geom_line(aes(y = attendance, group = hospital, color = hospital)) +
labs(title = "Attendance at Emergency Medicine Department",
subtitle = "January 2023",
x = "Date",
y = "No. of patients",
colour = "Hospital",
caption = "Source: Ministry of Health") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplotly(WT_line, tooltip = "text") %>%
config(displayModeBar = FALSE) %>%
layout(dragmode = FALSE,
title = list(text = paste0('Waiting Time for Admission to Ward',
'<br>',
'<sup>',
'January 2023',
'</sup>')))
ggplotly(BOR_line, tooltip = "text") %>%
config(displayModeBar = FALSE) %>%
layout(dragmode = FALSE,
title = list(text = paste0('Bed Occupancy Rate (%)',
'<br>',
'<sup>',
'January 2023',
'</sup>')))
ggplotly(EMD_line, tooltip = "text") %>%
config(displayModeBar = FALSE) %>%
layout(dragmode = FALSE,
title = list(text = paste0('Attendance at Emergency Medicine Department',
'<br>',
'<sup>',
'January 2023',
'</sup>')))
final_dataset %>%
filter(Month == "01") %>%
ggplot(aes(x = wait_duration,
y = fct_reorder(hospital, desc(hospital)))) +
geom_boxplot(aes(fill = hospital)) +
labs(title = "Waiting Time for Admission to Ward",
subtitle = "January, 2023",
x = "Hours (h)",
y = "Hospital",
caption = "Source: Ministry of Health") +
theme(legend.position = "none")
final_dataset %>%
filter(Month == "01") %>%
ggplot(aes(x = occ_rate_num,
y = fct_reorder(hospital, desc(hospital)))) +
geom_boxplot(aes(fill = hospital)) +
labs(title = "Bed Occupancy Rate (%)",
subtitle = "January, 2023",
x = "BOR (%)",
y = "Hospital",
caption = "Source: Ministry of Health") +
theme(legend.position = "none")
final_dataset %>%
filter(Month == "01") %>%
ggplot(aes(x = attendance,
y = fct_reorder(hospital, desc(hospital)))) +
geom_boxplot(aes(fill = hospital)) +
labs(title = "Attendance at Emergency Medicine Department",
subtitle = "January, 2023",
x = "No. of patients",
y = "Hospital",
caption = "Source: Ministry of Health") +
theme(legend.position = "none")
final_dataset %>%
filter(Month == "01",
Day == "01") %>%
ggplot(aes(x = occ_rate_num)) +
geom_col(aes(y = fct_reorder(hospital, desc(hospital)),
fill = hospital)) +
labs(title = "Bed Occupancy Rate (BOR)",
subtitle = "01/01/2023",
x = "BOR (%)",
y = "Hospital",
caption = "Source: Ministry of Health") +
geom_text(aes(occ_rate_num, hospital, label = occ_rate_num),
hjust = 1.3) +
theme(legend.position = "none")
final_dataset %>%
filter(Month == "01",
Day == "01") %>%
ggplot(aes(x = attendance)) +
geom_col(aes(y = fct_reorder(hospital, desc(hospital)),
fill = hospital)) +
labs(title = "Attendance at Emergency Medicine Department",
subtitle = "01/01/2023",
x = "No. of patients",
y = "Hospital",
caption = "Source: Ministry of Health") +
geom_text(aes(attendance, hospital, label = attendance),
hjust = 1.3) +
theme(legend.position = "none")
calendar_plot <- final_dataset %>%
filter(hospital == "AH") %>%
ggplot(aes(x = fct_inorder(Day_wk),
y = monthweek,
fill = wait_duration,
text = paste("Waiting time:", wait_duration, "hrs"))) +
geom_tile(colour = "white") +
geom_text(aes(label = Day),
color = "black",
size = 2) +
facet_wrap( ~ fct_inorder(fullmonth),
ncol = 3,
scales = "fixed") +
scale_fill_gradient(low="green", high = "red") +
labs(x = "Alexandra Hospital (2023)",
y = "",
title = "Waiting Time for Admission to Ward",
subtitle = "Alexandra Hospital (2023)",
fill = "Hours (h)",
caption = "Source: Ministry of Health") +
theme(axis.text.y=element_blank(),
axis.ticks.y=element_blank()) +
scale_x_discrete(guide = guide_axis(angle = 90)) +
theme(panel.spacing.y = unit(1.1, "cm"))
ggplotly(calendar_plot, tooltip = "text") %>%
config(displayModeBar = FALSE) %>%
layout(dragmode = FALSE)
final_dataset %>%
filter(Month == "01",
hospital == "AH") %>%
ggplot(aes(x = Dates)) +
geom_col(aes(y = occ_rate_num/10), fill = "lightgrey") +
geom_point(aes(y = wait_duration), size = 2) +
geom_line(aes(y = wait_duration, group = hospital, color = hospital), size = 0.75) +
labs(title = "Waiting Time for Admission to Ward & Bed Occupancy Rate (BOR)",
subtitle = "Alexandra Hospital (Jan, 2023)",
x = "Date",
y = "Hours (h)",
caption = "Source: Ministry of Health") +
theme(legend.position = "none") +
scale_y_continuous(sec.axis = sec_axis(~.*10, name = "BOR (%)")) +
scale_x_discrete(guide = guide_axis(angle = 45))
final_dataset %>%
filter(Month == "01",
hospital == "AH") %>%
ggplot(aes(x = Dates)) +
geom_col(aes(y = attendance/10), fill = "lightgrey") +
geom_point(aes(y = wait_duration), size = 2) +
geom_line(aes(y = wait_duration, group = hospital, color = hospital), size = 0.75) +
labs(title = "Waiting Time for Admission to Ward & EMD Attendance",
subtitle = "Alexandra Hospital (Jan, 2023)",
x = "Date",
y = "Hours (h)",
caption = "Source: Ministry of Health") +
theme(legend.position = "none") +
scale_y_continuous(sec.axis = sec_axis(~.*10, name = "EMD Attendance")) +
scale_x_discrete(guide = guide_axis(angle = 45))
final_dataset %>%
filter(Month == "01",
hospital == "AH") %>%
ggplot(aes(wait_duration, occ_rate_num)) +
geom_point() +
geom_smooth(method = "lm", se=F) +
labs(title = "Waiting Time for Admission to Ward & Bed Occupancy Rate (BOR)",
subtitle = "Alexandra Hospital (Jan, 2023)",
x = "Hours (h)",
y = "BOR (%)",
caption = "Source: Ministry of Health")
final_dataset %>%
filter(Month == "01",
hospital == "AH") %>%
ggplot(aes(wait_duration, attendance)) +
geom_point() +
geom_smooth(method = "lm", se=F) +
labs(title = "Waiting Time for Admission to Ward & EMD attendance",
subtitle = "Alexandra Hospital (Jan, 2023)",
x = "Hours (h)",
y = "No. of patients",
caption = "Source: Ministry of Health")
library(tidyverse)
library(ggplot2)
library(tidyr)
library(readr)
library(lubridate)
library(plyr)
library(scales)
library(zoo)
library(leaflet)
library(htmltools)
library(plotly)
library(ggh4x)
library(ggrepel)
wait_times <- read_csv("../Proj dataset/test_waiting_time.csv")
library(tidyverse)
library(ggplot2)
library(tidyr)
library(readr)
library(lubridate)
library(plyr)
library(scales)
library(zoo)
library(leaflet)
library(htmltools)
library(plotly)
library(ggh4x)
library(ggrepel)
wait_times <- read_csv("test_waiting_time.csv")
library(tidyverse)
library(ggplot2)
library(tidyr)
library(readr)
library(lubridate)
library(plyr)
library(scales)
library(zoo)
library(leaflet)
library(htmltools)
library(plotly)
library(ggh4x)
library(ggrepel)
wait_times <- read_csv("../test_waiting_time.csv")
library(tidyverse)
library(ggplot2)
library(tidyr)
library(readr)
library(lubridate)
library(plyr)
library(scales)
library(zoo)
library(leaflet)
library(htmltools)
library(plotly)
library(ggh4x)
library(ggrepel)
wait_times <- read_csv("../Proj dataset/test_waiting_time.csv")
setwd("~/GitHub/bocongg.github.io")
library(tidyverse)
library(ggplot2)
library(tidyr)
library(readr)
library(lubridate)
library(plyr)
library(scales)
library(zoo)
library(leaflet)
library(htmltools)
library(plotly)
library(ggh4x)
library(ggrepel)
wait_times <- read_csv("../Proj dataset/test_waiting_time.csv")
library(tidyverse)
library(ggplot2)
library(tidyr)
library(readr)
library(lubridate)
library(plyr)
library(scales)
library(zoo)
library(leaflet)
library(htmltools)
library(plotly)
library(ggh4x)
library(ggrepel)
wait_times <- read_csv("test_waiting_time.csv")
library(tidyverse)
library(ggplot2)
library(tidyr)
library(readr)
library(lubridate)
library(plyr)
library(scales)
library(zoo)
library(leaflet)
library(htmltools)
library(plotly)
library(ggh4x)
library(ggrepel)
wait_times <- read_csv("./Proj dataset/test_waiting_time.csv")
bed_occ <- read_csv("./Proj dataset/test_BOR.csv")
EMD_attendance <- read_csv("./Proj dataset/test_EMD_attendance.csv")
tidy_wait_times <- wait_times %>%
separate(col = Date, into = c("Day_wk", "Date"), sep = ", ") %>%
mutate(new_Date_format =
parse_date_time(Date, orders = c("mdy", "dmy", "ymd"))) %>%
mutate(Dates = format(new_Date_format, "%d/%m/%Y")) %>%
separate(col = Date, into = c("Day", "Month", "Year"), sep = "/") %>%
gather(key = hospital, value = wait_duration, 5:12 ) %>%
select(Day_wk, Dates, Day, Month, Year, hospital, wait_duration)
tidy_bed_occ <- bed_occ %>%
filter(Years == 2023) %>%
mutate(new_Date_format =
parse_date_time(Date, orders = c("mdy", "dmy", "ymd"))) %>%
mutate(Dates = format(new_Date_format, "%d/%m/%Y")) %>%
gather(key = hospital, value = occ_rate, 3:10) %>%
separate(col = occ_rate, into = c("occ_rate"), sep = "%") %>%
mutate(occ_rate_num = as.numeric(occ_rate)) %>%
select(occ_rate_num)
tidy_EMD_attendance <- EMD_attendance %>%
separate(col = Date, into = c("Day_wk", "Date"), sep = ", ") %>%
mutate(new_Date_format =
parse_date_time(Date, orders = c("mdy", "dmy", "ymd"))) %>%
mutate(Dates = format(new_Date_format, "%d/%m/%Y")) %>%
separate(col = Date, into = c("Day", "Month", "Year"), sep = "/") %>%
gather(key = hospital, value = attendance, 5:12) %>%
select(attendance)
final_dataset <- cbind(tidy_wait_times,tidy_bed_occ,tidy_EMD_attendance)
final_dataset <-
final_dataset %>%
mutate(new_Date_format =
parse_date_time(Dates, orders = c("mdy", "dmy", "ymd"))) %>%
mutate(week_num = as.numeric(format(new_Date_format, "%U"))) %>%
mutate(fullmonth = format(new_Date_format, "%b")) %>%
mutate(yearmonth = as.yearmon(new_Date_format)) %>%
mutate(yearmonthf = factor(yearmonth)) %>%
ddply(.(yearmonthf), transform, monthweek=5-week_num+min(week_num)) %>%
select(-new_Date_format,-yearmonth,-yearmonthf)
WT_line <- final_dataset %>%
filter(Month == "01") %>%
ggplot(aes(x = Dates,
text = paste(wait_duration, "hrs"))) +
geom_point(aes(y = wait_duration), size = 0.75) +
geom_line(aes(y = wait_duration, group = hospital, color = hospital)) +
labs(title = "Waiting Time for Admission to Ward",
subtitle = "January 2023",
x = "Date",
y = "Hours (h)",
colour = "Hospital",
caption = "Source: Ministry of Health") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
BOR_line <- final_dataset %>%
filter(Month == "01") %>%
ggplot(aes(x = Dates,
text = paste(occ_rate_num, "%"))) +
geom_point(aes(y = occ_rate_num), size = 0.75) +
geom_line(aes(y = occ_rate_num, group = hospital, color = hospital)) +
labs(title = "Bed Occupancy Rate (%)",
subtitle = "January 2023",
x = "Date",
y = "BOR (%)",
colour = "Hospital",
caption = "Source: Ministry of Health") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
EMD_line <- final_dataset %>%
filter(Month == "01") %>%
ggplot(aes(x = Dates,
text = paste(wait_duration, "patients"))) +
geom_point(aes(y = attendance), size = 0.75) +
geom_line(aes(y = attendance, group = hospital, color = hospital)) +
labs(title = "Attendance at Emergency Medicine Department",
subtitle = "January 2023",
x = "Date",
y = "No. of patients",
colour = "Hospital",
caption = "Source: Ministry of Health") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplotly(WT_line, tooltip = "text") %>%
config(displayModeBar = FALSE) %>%
layout(dragmode = FALSE,
title = list(text = paste0('Waiting Time for Admission to Ward',
'<br>',
'<sup>',
'January 2023',
'</sup>')))
ggplotly(BOR_line, tooltip = "text") %>%
config(displayModeBar = FALSE) %>%
layout(dragmode = FALSE,
title = list(text = paste0('Bed Occupancy Rate (%)',
'<br>',
'<sup>',
'January 2023',
'</sup>')))
ggplotly(EMD_line, tooltip = "text") %>%
config(displayModeBar = FALSE) %>%
layout(dragmode = FALSE,
title = list(text = paste0('Attendance at Emergency Medicine Department',
'<br>',
'<sup>',
'January 2023',
'</sup>')))
final_dataset %>%
filter(Month == "01") %>%
ggplot(aes(x = wait_duration,
y = fct_reorder(hospital, desc(hospital)))) +
geom_boxplot(aes(fill = hospital)) +
labs(title = "Waiting Time for Admission to Ward",
subtitle = "January, 2023",
x = "Hours (h)",
y = "Hospital",
caption = "Source: Ministry of Health") +
theme(legend.position = "none")
final_dataset %>%
filter(Month == "01") %>%
ggplot(aes(x = occ_rate_num,
y = fct_reorder(hospital, desc(hospital)))) +
geom_boxplot(aes(fill = hospital)) +
labs(title = "Bed Occupancy Rate (%)",
subtitle = "January, 2023",
x = "BOR (%)",
y = "Hospital",
caption = "Source: Ministry of Health") +
theme(legend.position = "none")
final_dataset %>%
filter(Month == "01") %>%
ggplot(aes(x = attendance,
y = fct_reorder(hospital, desc(hospital)))) +
geom_boxplot(aes(fill = hospital)) +
labs(title = "Attendance at Emergency Medicine Department",
subtitle = "January, 2023",
x = "No. of patients",
y = "Hospital",
caption = "Source: Ministry of Health") +
theme(legend.position = "none")
final_dataset %>%
filter(Month == "01",
Day == "01") %>%
ggplot(aes(x = occ_rate_num)) +
geom_col(aes(y = fct_reorder(hospital, desc(hospital)),
fill = hospital)) +
labs(title = "Bed Occupancy Rate (BOR)",
subtitle = "01/01/2023",
x = "BOR (%)",
y = "Hospital",
caption = "Source: Ministry of Health") +
geom_text(aes(occ_rate_num, hospital, label = occ_rate_num),
hjust = 1.3) +
theme(legend.position = "none")
final_dataset %>%
filter(Month == "01",
Day == "01") %>%
ggplot(aes(x = attendance)) +
geom_col(aes(y = fct_reorder(hospital, desc(hospital)),
fill = hospital)) +
labs(title = "Attendance at Emergency Medicine Department",
subtitle = "01/01/2023",
x = "No. of patients",
y = "Hospital",
caption = "Source: Ministry of Health") +
geom_text(aes(attendance, hospital, label = attendance),
hjust = 1.3) +
theme(legend.position = "none")
calendar_plot <- final_dataset %>%
filter(hospital == "AH") %>%
ggplot(aes(x = fct_inorder(Day_wk),
y = monthweek,
fill = wait_duration,
text = paste("Waiting time:", wait_duration, "hrs"))) +
geom_tile(colour = "white") +
geom_text(aes(label = Day),
color = "black",
size = 2) +
facet_wrap( ~ fct_inorder(fullmonth),
ncol = 3,
scales = "fixed") +
scale_fill_gradient(low="green", high = "red") +
labs(x = "Alexandra Hospital (2023)",
y = "",
title = "Waiting Time for Admission to Ward",
subtitle = "Alexandra Hospital (2023)",
fill = "Hours (h)",
caption = "Source: Ministry of Health") +
theme(axis.text.y=element_blank(),
axis.ticks.y=element_blank()) +
scale_x_discrete(guide = guide_axis(angle = 90)) +
theme(panel.spacing.y = unit(1.1, "cm"))
ggplotly(calendar_plot, tooltip = "text") %>%
config(displayModeBar = FALSE) %>%
layout(dragmode = FALSE)
final_dataset %>%
filter(Month == "01",
hospital == "AH") %>%
ggplot(aes(x = Dates)) +
geom_col(aes(y = occ_rate_num/10), fill = "lightgrey") +
geom_point(aes(y = wait_duration), size = 2) +
geom_line(aes(y = wait_duration, group = hospital, color = hospital), size = 0.75) +
labs(title = "Waiting Time for Admission to Ward & Bed Occupancy Rate (BOR)",
subtitle = "Alexandra Hospital (Jan, 2023)",
x = "Date",
y = "Hours (h)",
caption = "Source: Ministry of Health") +
theme(legend.position = "none") +
scale_y_continuous(sec.axis = sec_axis(~.*10, name = "BOR (%)")) +
scale_x_discrete(guide = guide_axis(angle = 45))
final_dataset %>%
filter(Month == "01",
hospital == "AH") %>%
ggplot(aes(x = Dates)) +
geom_col(aes(y = attendance/10), fill = "lightgrey") +
geom_point(aes(y = wait_duration), size = 2) +
geom_line(aes(y = wait_duration, group = hospital, color = hospital), size = 0.75) +
labs(title = "Waiting Time for Admission to Ward & EMD Attendance",
subtitle = "Alexandra Hospital (Jan, 2023)",
x = "Date",
y = "Hours (h)",
caption = "Source: Ministry of Health") +
theme(legend.position = "none") +
scale_y_continuous(sec.axis = sec_axis(~.*10, name = "EMD Attendance")) +
scale_x_discrete(guide = guide_axis(angle = 45))
final_dataset %>%
filter(Month == "01",
hospital == "AH") %>%
ggplot(aes(wait_duration, occ_rate_num)) +
geom_point() +
geom_smooth(method = "lm", se=F) +
labs(title = "Waiting Time for Admission to Ward & Bed Occupancy Rate (BOR)",
subtitle = "Alexandra Hospital (Jan, 2023)",
x = "Hours (h)",
y = "BOR (%)",
caption = "Source: Ministry of Health")
final_dataset %>%
filter(Month == "01",
hospital == "AH") %>%
ggplot(aes(wait_duration, attendance)) +
geom_point() +
geom_smooth(method = "lm", se=F) +
labs(title = "Waiting Time for Admission to Ward & EMD attendance",
subtitle = "Alexandra Hospital (Jan, 2023)",
x = "Hours (h)",
y = "No. of patients",
caption = "Source: Ministry of Health")
